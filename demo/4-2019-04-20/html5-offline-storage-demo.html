<!DOCTYPE html>
<html lang="zh-CN" manifest="cache.manifest">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML5ç¦»çº¿å­˜å‚¨æ¼”ç¤º</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
        }
        
        .section h2 {
            color: #333;
            margin-top: 0;
            font-size: 1.8em;
        }
        
        .section h3 {
            color: #555;
            margin-top: 25px;
            font-size: 1.3em;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        
        .warning {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            margin: 15px 0;
        }
        
        .demo-area {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.online {
            background: #d4edda;
            color: #155724;
        }
        
        .status.offline {
            background: #f8d7da;
            color: #721c24;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>HTML5 ç¦»çº¿å­˜å‚¨è¯¦è§£</h1>
            <p>Application Cache çš„ä½¿ç”¨æ–¹æ³•ä¸å·¥ä½œåŸç†</p>
        </div>
        
        <div class="content">
            <!-- æ¦‚è¿°éƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸ“– ä»€ä¹ˆæ˜¯HTML5ç¦»çº¿å­˜å‚¨ï¼Ÿ</h2>
                <p>HTML5ç¦»çº¿å­˜å‚¨ï¼ˆApplication Cacheï¼‰æ˜¯HTML5æä¾›çš„ä¸€ç§æŠ€æœ¯ï¼Œå…è®¸webåº”ç”¨ç¨‹åºåœ¨æ²¡æœ‰ç½‘ç»œè¿æ¥çš„æƒ…å†µä¸‹ä»èƒ½æ­£å¸¸è¿è¡Œã€‚å®ƒé€šè¿‡ç¼“å­˜æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œä½¿ç”¨æˆ·åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿèƒ½è®¿é—®åº”ç”¨ç¨‹åºã€‚</p>
                
                <div class="highlight">
                    <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong> é€šè¿‡manifestæ–‡ä»¶å®šä¹‰éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å­˜å‚¨è¿™äº›èµ„æºï¼Œåœ¨ç¦»çº¿æ—¶ä»ç¼“å­˜ä¸­åŠ è½½ã€‚
                </div>
            </div>

            <!-- ä½¿ç”¨æ–¹æ³•éƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸš€ å¦‚ä½•ä½¿ç”¨ç¦»çº¿å­˜å‚¨ï¼Ÿ</h2>
                
                <h3>1. åœ¨HTMLæ ‡ç­¾ä¸­å£°æ˜manifest</h3>
                <div class="code-block">
&lt;html manifest="cache.manifest"&gt;
    &lt;!-- é¡µé¢å†…å®¹ --&gt;
&lt;/html&gt;
                </div>
                
                <h3>2. åˆ›å»ºmanifestæ–‡ä»¶</h3>
                <p>åˆ›å»ºä¸€ä¸ªåä¸º <code>cache.manifest</code> çš„æ–‡ä»¶ï¼š</p>
                <div class="code-block">
CACHE MANIFEST
# ç‰ˆæœ¬å·ï¼šv1.0.0

# éœ€è¦ç¼“å­˜çš„æ–‡ä»¶
CACHE:
index.html
style.css
script.js
images/logo.png

# ä¸ç¼“å­˜çš„æ–‡ä»¶ï¼ˆæ€»æ˜¯ä»ç½‘ç»œè·å–ï¼‰
NETWORK:
api/
login.php
*

# å›é€€é¡µé¢ï¼ˆå½“ç½‘ç»œèµ„æºä¸å¯ç”¨æ—¶çš„æ›¿ä»£é¡µé¢ï¼‰
FALLBACK:
/ offline.html
images/ images/offline.png
                </div>
                
                <h3>3. è®¾ç½®æ­£ç¡®çš„MIMEç±»å‹</h3>
                <p>æœåŠ¡å™¨éœ€è¦ä¸ºmanifestæ–‡ä»¶è®¾ç½®æ­£ç¡®çš„MIMEç±»å‹ï¼š</p>
                <div class="code-block">
# Apache (.htaccess)
AddType text/cache-manifest .manifest

# Nginx
location ~* \.manifest$ {
    add_header Content-Type text/cache-manifest;
}
                </div>
            </div>

            <!-- å·¥ä½œåŸç†éƒ¨åˆ† -->
            <div class="section">
                <h2>âš™ï¸ å·¥ä½œåŸç†</h2>
                
                <h3>ç¼“å­˜è¿‡ç¨‹ï¼š</h3>
                <ol>
                    <li><strong>é¦–æ¬¡è®¿é—®ï¼š</strong> æµè§ˆå™¨è§£æHTMLï¼Œå‘ç°manifestå±æ€§</li>
                    <li><strong>ä¸‹è½½manifestï¼š</strong> æµè§ˆå™¨ä¸‹è½½å¹¶è§£æmanifestæ–‡ä»¶</li>
                    <li><strong>ç¼“å­˜èµ„æºï¼š</strong> æ ¹æ®manifestæ–‡ä»¶ä¸‹è½½å¹¶ç¼“å­˜æ‰€æœ‰åˆ—å‡ºçš„èµ„æº</li>
                    <li><strong>è§¦å‘äº‹ä»¶ï¼š</strong> ç¼“å­˜å®Œæˆåè§¦å‘ç›¸åº”çš„JavaScriptäº‹ä»¶</li>
                    <li><strong>ç¦»çº¿è®¿é—®ï¼š</strong> åç»­è®¿é—®æ—¶ï¼Œå¦‚æœç¦»çº¿åˆ™ä»ç¼“å­˜åŠ è½½èµ„æº</li>
                </ol>
                
                <h3>ç¼“å­˜çŠ¶æ€ï¼š</h3>
                <ul>
                    <li><strong>UNCACHED (0)ï¼š</strong> æœªç¼“å­˜çŠ¶æ€</li>
                    <li><strong>IDLE (1)ï¼š</strong> ç©ºé—²çŠ¶æ€ï¼Œç¼“å­˜æ˜¯æœ€æ–°çš„</li>
                    <li><strong>CHECKING (2)ï¼š</strong> æ­£åœ¨æ£€æŸ¥æ›´æ–°</li>
                    <li><strong>DOWNLOADING (3)ï¼š</strong> æ­£åœ¨ä¸‹è½½èµ„æº</li>
                    <li><strong>UPDATEREADY (4)ï¼š</strong> æ–°ç‰ˆæœ¬ä¸‹è½½å®Œæˆ</li>
                    <li><strong>OBSOLETE (5)ï¼š</strong> ç¼“å­˜å·²è¿‡æ—¶</li>
                </ul>
            </div>

            <!-- JavaScript APIéƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸ’» JavaScript API</h2>
                
                <div class="code-block">
// è·å–åº”ç”¨ç¼“å­˜å¯¹è±¡
var appCache = window.applicationCache;

// æ£€æŸ¥ç¼“å­˜çŠ¶æ€
function checkCacheStatus() {
    var status = appCache.status;
    var statusText = '';
    
    switch(status) {
        case appCache.UNCACHED:
            statusText = 'æœªç¼“å­˜';
            break;
        case appCache.IDLE:
            statusText = 'ç©ºé—²çŠ¶æ€';
            break;
        case appCache.CHECKING:
            statusText = 'æ£€æŸ¥æ›´æ–°ä¸­';
            break;
        case appCache.DOWNLOADING:
            statusText = 'ä¸‹è½½ä¸­';
            break;
        case appCache.UPDATEREADY:
            statusText = 'æ›´æ–°å°±ç»ª';
            break;
        case appCache.OBSOLETE:
            statusText = 'ç¼“å­˜è¿‡æ—¶';
            break;
    }
    
    return statusText;
}

// ç›‘å¬ç¼“å­˜äº‹ä»¶
appCache.addEventListener('cached', function() {
    console.log('èµ„æºå·²ç¼“å­˜');
});

appCache.addEventListener('checking', function() {
    console.log('æ£€æŸ¥æ›´æ–°ä¸­...');
});

appCache.addEventListener('downloading', function() {
    console.log('ä¸‹è½½æ–°èµ„æºä¸­...');
});

appCache.addEventListener('updateready', function() {
    console.log('æ–°ç‰ˆæœ¬å°±ç»ª');
    if (confirm('å‘ç°æ–°ç‰ˆæœ¬ï¼Œæ˜¯å¦ç«‹å³æ›´æ–°ï¼Ÿ')) {
        appCache.swapCache();
        location.reload();
    }
});

appCache.addEventListener('error', function() {
    console.log('ç¼“å­˜å‡ºé”™');
});

// æ‰‹åŠ¨æ›´æ–°ç¼“å­˜
function updateCache() {
    try {
        appCache.update();
    } catch(e) {
        console.log('æ›´æ–°å¤±è´¥ï¼š', e);
    }
}
                </div>
            </div>

            <!-- å®é™…æ¼”ç¤ºéƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸ¯ å®é™…æ¼”ç¤º</h2>
                
                <div class="demo-area">
                    <h3>å½“å‰çŠ¶æ€æ£€æµ‹</h3>
                    <div id="networkStatus" class="status">æ£€æµ‹ä¸­...</div>
                    <div id="cacheStatus">ç¼“å­˜çŠ¶æ€ï¼š<span id="cacheStatusText">æ£€æµ‹ä¸­...</span></div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn" onclick="checkStatus()">æ£€æŸ¥çŠ¶æ€</button>
                        <button class="btn" onclick="updateCache()">æ›´æ–°ç¼“å­˜</button>
                        <button class="btn" onclick="clearCache()">æ¸…é™¤ç¼“å­˜</button>
                    </div>
                    
                    <div id="log" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- æ³¨æ„äº‹é¡¹éƒ¨åˆ† -->
            <div class="section">
                <h2>âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹</h2>
                
                <div class="warning">
                    <strong>å·²åºŸå¼ƒè­¦å‘Šï¼š</strong> Application Cache å·²åœ¨ç°ä»£æµè§ˆå™¨ä¸­è¢«åºŸå¼ƒï¼Œæ¨èä½¿ç”¨ Service Worker æ›¿ä»£ã€‚
                </div>
                
                <h3>ä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹ï¼š</h3>
                <ul>
                    <li>manifestæ–‡ä»¶å¿…é¡»è®¾ç½®æ­£ç¡®çš„MIMEç±»å‹</li>
                    <li>æ›´æ–°ç¼“å­˜éœ€è¦ä¿®æ”¹manifestæ–‡ä»¶ï¼ˆé€šå¸¸ä¿®æ”¹ç‰ˆæœ¬å·æ³¨é‡Šï¼‰</li>
                    <li>ç¼“å­˜çš„é¡µé¢å³ä½¿åœ¨çº¿ä¹Ÿä¼šä»ç¼“å­˜åŠ è½½ï¼Œé™¤éç¼“å­˜æ›´æ–°</li>
                    <li>å¦‚æœmanifestæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ•´ä¸ªç¼“å­˜ä¼šè¢«æ¸…é™¤</li>
                    <li>HTTPSé¡µé¢çš„manifestæ–‡ä»¶ä¹Ÿå¿…é¡»æ˜¯HTTPS</li>
                </ul>
                
                <h3>ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼š</h3>
                <ul>
                    <li><strong>Service Workerï¼š</strong> æ›´å¼ºå¤§çš„ç¦»çº¿ç¼“å­˜è§£å†³æ–¹æ¡ˆ</li>
                    <li><strong>Cache APIï¼š</strong> ç¨‹åºåŒ–çš„ç¼“å­˜ç®¡ç†</li>
                    <li><strong>IndexedDBï¼š</strong> å®¢æˆ·ç«¯æ•°æ®å­˜å‚¨</li>
                    <li><strong>localStorage/sessionStorageï¼š</strong> ç®€å•çš„é”®å€¼å¯¹å­˜å‚¨</li>
                </ul>
            </div>

            <!-- å®Œæ•´ç¤ºä¾‹éƒ¨åˆ† -->
            <div class="section">
                <h2>ğŸ“ å®Œæ•´ç¤ºä¾‹</h2>
                
                <h3>manifestæ–‡ä»¶ç¤ºä¾‹ï¼š</h3>
                <div class="code-block">
CACHE MANIFEST
# Version 1.0.0 - 2024-01-01

# æ˜ç¡®ç¼“å­˜çš„æ–‡ä»¶
CACHE:
index.html
css/style.css
js/app.js
images/logo.png
fonts/custom-font.woff

# å§‹ç»ˆä»ç½‘ç»œè·å–çš„èµ„æº
NETWORK:
api/
login
logout
*

# ç¦»çº¿æ—¶çš„å›é€€é¡µé¢
FALLBACK:
/ offline.html
api/ offline-api.json
                </div>
                
                <h3>JavaScriptå¤„ç†ç¤ºä¾‹ï¼š</h3>
                <div class="code-block">
(function() {
    'use strict';
    
    var appCache = window.applicationCache;
    
    if (!appCache) {
        console.log('æµè§ˆå™¨ä¸æ”¯æŒApplication Cache');
        return;
    }
    
    // ç¼“å­˜äº‹ä»¶å¤„ç†
    function handleCacheEvent(e) {
        console.log('ç¼“å­˜äº‹ä»¶ï¼š', e.type);
        updateUI();
    }
    
    // ç»‘å®šæ‰€æœ‰ç¼“å­˜äº‹ä»¶
    var events = ['cached', 'checking', 'downloading', 'error', 
                  'noupdate', 'obsolete', 'progress', 'updateready'];
    
    events.forEach(function(event) {
        appCache.addEventListener(event, handleCacheEvent);
    });
    
    // å¤„ç†æ›´æ–°å°±ç»ªäº‹ä»¶
    appCache.addEventListener('updateready', function() {
        if (appCache.status === appCache.UPDATEREADY) {
            if (confirm('åº”ç”¨ç¨‹åºå·²æ›´æ–°ï¼Œæ˜¯å¦é‡æ–°åŠ è½½ï¼Ÿ')) {
                appCache.swapCache();
                window.location.reload();
            }
        }
    });
    
    // æ›´æ–°UIçŠ¶æ€
    function updateUI() {
        var statusElement = document.getElementById('cache-status');
        if (statusElement) {
            statusElement.textContent = getCacheStatusText();
        }
    }
    
    // è·å–ç¼“å­˜çŠ¶æ€æ–‡æœ¬
    function getCacheStatusText() {
        switch(appCache.status) {
            case appCache.UNCACHED: return 'æœªç¼“å­˜';
            case appCache.IDLE: return 'ç©ºé—²';
            case appCache.CHECKING: return 'æ£€æŸ¥ä¸­';
            case appCache.DOWNLOADING: return 'ä¸‹è½½ä¸­';
            case appCache.UPDATEREADY: return 'æ›´æ–°å°±ç»ª';
            case appCache.OBSOLETE: return 'å·²è¿‡æ—¶';
            default: return 'æœªçŸ¥çŠ¶æ€';
        }
    }
    
    // åˆå§‹åŒ–
    updateUI();
})();
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç½‘ç»œçŠ¶æ€æ£€æµ‹
        function updateNetworkStatus() {
            var statusElement = document.getElementById('networkStatus');
            if (navigator.onLine) {
                statusElement.textContent = 'åœ¨çº¿çŠ¶æ€';
                statusElement.className = 'status online';
            } else {
                statusElement.textContent = 'ç¦»çº¿çŠ¶æ€';
                statusElement.className = 'status offline';
            }
        }

        // æ£€æŸ¥ç¼“å­˜çŠ¶æ€
        function checkCacheStatus() {
            var appCache = window.applicationCache;
            var statusText = 'ä¸æ”¯æŒ';
            
            if (appCache) {
                switch(appCache.status) {
                    case appCache.UNCACHED:
                        statusText = 'æœªç¼“å­˜ (0)';
                        break;
                    case appCache.IDLE:
                        statusText = 'ç©ºé—²çŠ¶æ€ (1)';
                        break;
                    case appCache.CHECKING:
                        statusText = 'æ£€æŸ¥æ›´æ–°ä¸­ (2)';
                        break;
                    case appCache.DOWNLOADING:
                        statusText = 'ä¸‹è½½ä¸­ (3)';
                        break;
                    case appCache.UPDATEREADY:
                        statusText = 'æ›´æ–°å°±ç»ª (4)';
                        break;
                    case appCache.OBSOLETE:
                        statusText = 'ç¼“å­˜è¿‡æ—¶ (5)';
                        break;
                }
            }
            
            document.getElementById('cacheStatusText').textContent = statusText;
        }

        // æ—¥å¿—è®°å½•
        function log(message) {
            var logElement = document.getElementById('log');
            var time = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${time}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // æ£€æŸ¥çŠ¶æ€
        function checkStatus() {
            updateNetworkStatus();
            checkCacheStatus();
            log('çŠ¶æ€æ£€æŸ¥å®Œæˆ');
        }

        // æ›´æ–°ç¼“å­˜
        function updateCache() {
            var appCache = window.applicationCache;
            if (appCache) {
                try {
                    appCache.update();
                    log('å¼€å§‹æ£€æŸ¥ç¼“å­˜æ›´æ–°...');
                } catch(e) {
                    log('æ›´æ–°å¤±è´¥ï¼š' + e.message);
                }
            } else {
                log('æµè§ˆå™¨ä¸æ”¯æŒApplication Cache');
            }
        }

        // æ¸…é™¤ç¼“å­˜ï¼ˆå®é™…ä¸Šæ˜¯æ ‡è®°ä¸ºè¿‡æ—¶ï¼‰
        function clearCache() {
            log('æ³¨æ„ï¼šApplication Cacheæ— æ³•é€šè¿‡JavaScriptç›´æ¥æ¸…é™¤');
            log('éœ€è¦åˆ é™¤manifestæ–‡ä»¶æˆ–ä¿®æ”¹æœåŠ¡å™¨é…ç½®');
        }

        // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
        window.addEventListener('online', function() {
            updateNetworkStatus();
            log('ç½‘ç»œè¿æ¥å·²æ¢å¤');
        });

        window.addEventListener('offline', function() {
            updateNetworkStatus();
            log('ç½‘ç»œè¿æ¥å·²æ–­å¼€');
        });

        // ç›‘å¬Application Cacheäº‹ä»¶
        if (window.applicationCache) {
            var appCache = window.applicationCache;
            
            appCache.addEventListener('cached', function() {
                log('èµ„æºå·²ç¼“å­˜åˆ°æœ¬åœ°');
            });
            
            appCache.addEventListener('checking', function() {
                log('æ­£åœ¨æ£€æŸ¥manifestæ–‡ä»¶æ›´æ–°...');
            });
            
            appCache.addEventListener('downloading', function() {
                log('æ­£åœ¨ä¸‹è½½æ›´æ–°çš„èµ„æº...');
            });
            
            appCache.addEventListener('updateready', function() {
                log('æ–°ç‰ˆæœ¬å·²ä¸‹è½½å®Œæˆï¼Œå¯ä»¥æ›´æ–°');
                checkCacheStatus();
            });
            
            appCache.addEventListener('noupdate', function() {
                log('manifestæ–‡ä»¶æœªå‘ç”Ÿå˜åŒ–');
            });
            
            appCache.addEventListener('error', function() {
                log('ç¼“å­˜è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯');
            });
            
            appCache.addEventListener('obsolete', function() {
                log('manifestæ–‡ä»¶è¿”å›404ï¼Œç¼“å­˜è¢«æ ‡è®°ä¸ºè¿‡æ—¶');
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            checkStatus();
            log('é¡µé¢åŠ è½½å®Œæˆï¼ŒApplication Cacheæ¼”ç¤ºå·²å°±ç»ª');
        });
    </script>
</body>
</html> 